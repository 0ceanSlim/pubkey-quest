{{define "nav-other"}}
<div class="relative group">
  <button
    onclick="toggleDropdown('otherDropdown')"
    class="p-2 transition win95-button pixel-clip hover:opacity-80 whitespace-nowrap"
    style="color: var(--color-textPrimary)"
    title="Other Stuff"
  >
    <span class="text-sm sm:text-base">âš™ï¸</span>
  </button>

  <!-- Dropdown container -->
  <div
    id="otherDropdown"
    class="absolute right-0 hidden mt-2 shadow-lg win95-outset pixel-clip"
    style="
      min-width: 14rem;
      z-index: 50;
      border: 4px solid var(--color-textPrimary);
    "
  >
    <ul class="py-2">
      <li>
        <a
          class="block px-4 py-2 transition-colors whitespace-nowrap hover:bg-opacity-20"
          style="color: var(--color-textPrimary)"
          onmouseover="this.style.backgroundColor='var(--color-textHighlighted)'; this.style.color='var(--color-bgPrimary)'"
          onmouseout="this.style.backgroundColor=''; this.style.color='var(--color-textPrimary)'"
          hx-trigger="click"
          href="/"
          hx-get="/"
          hx-push-url="/"
          hx-swap="outerHTML"
          hx-target="body"
        >
          âš”ï¸ Home
        </a>
      </li>
      <li>
        <a
          href="/discover"
          hx-push-url="/discover"
          class="block px-4 py-2 transition-colors whitespace-nowrap"
          style="color: var(--color-textPrimary)"
          onmouseover="this.style.backgroundColor='var(--color-textHighlighted)'; this.style.color='var(--color-bgPrimary)'"
          onmouseout="this.style.backgroundColor=''; this.style.color='var(--color-textPrimary)'"
          hx-trigger="click"
          hx-get="/discover"
          hx-swap="outerHTML"
          hx-target="body"
        >
          â›ï¸ Discover
        </a>
      </li>
      <li>
        <a
          href="/alpha-registry"
          hx-push-url="/alpha-registry"
          class="block px-4 py-2 transition-colors whitespace-nowrap"
          style="color: var(--color-textPrimary)"
          onmouseover="this.style.backgroundColor='var(--color-textHighlighted)'; this.style.color='var(--color-bgPrimary)'"
          onmouseout="this.style.backgroundColor=''; this.style.color='var(--color-textPrimary)'"
          hx-trigger="click"
          hx-get="/alpha-registry"
          hx-swap="outerHTML"
          hx-target="body"
        >
          ğŸ“œ Alpha Registry
        </a>
      </li>
      <li>
        <a
          href="/legacy-registry"
          hx-push-url="/legacy-registry"
          class="block px-4 py-2 transition-colors whitespace-nowrap"
          style="color: var(--color-textPrimary)"
          onmouseover="this.style.backgroundColor='var(--color-textHighlighted)'; this.style.color='var(--color-bgPrimary)'"
          onmouseout="this.style.backgroundColor=''; this.style.color='var(--color-textPrimary)'"
          hx-trigger="click"
          hx-get="/legacy-registry"
          hx-swap="outerHTML"
          hx-target="body"
        >
          ğŸ—¡ï¸ Legacy Registry
        </a>
      </li>
      <li>
        <a
          href="https://github.com/0ceanSlim/pubkey-quest"
          class="block px-4 py-2 transition-colors whitespace-nowrap"
          style="color: var(--color-textPrimary)"
          onmouseover="this.style.backgroundColor='var(--color-textHighlighted)'; this.style.color='var(--color-bgPrimary)'"
          onmouseout="this.style.backgroundColor=''; this.style.color='var(--color-textPrimary)'"
          target="_blank"
        >
          ğŸ’» GitHub
        </a>
      </li>
      <li>
        <a
          href="https://happytavern.co"
          class="block px-4 py-2 transition-colors whitespace-nowrap"
          style="color: var(--color-textPrimary)"
          onmouseover="this.style.backgroundColor='var(--color-textHighlighted)'; this.style.color='var(--color-bgPrimary)'"
          onmouseout="this.style.backgroundColor=''; this.style.color='var(--color-textPrimary)'"
          target="_blank"
        >
          ğŸ» Happy Tavern
        </a>
      </li>
      <li id="logout-item" class="hidden">
        <button
          onclick="handleLogout()"
          class="block w-full px-4 py-2 text-left transition-colors whitespace-nowrap"
          style="color: rgb(239, 68, 68)"
          onmouseover="this.style.backgroundColor='rgb(239, 68, 68)'; this.style.color='var(--color-bgPrimary)'"
          onmouseout="this.style.backgroundColor=''; this.style.color='rgb(239, 68, 68)'"
        >
          ğŸšª Logout
        </button>
      </li>
    </ul>
  </div>
</div>

<script>
  // Show/hide logout button based on authentication status
  function updateAuthUI() {
    const logoutItem = document.getElementById("logout-item");
    if (
      logoutItem &&
      window.sessionManager &&
      window.sessionManager.isAuthenticated()
    ) {
      logoutItem.classList.remove("hidden");
    } else if (logoutItem) {
      logoutItem.classList.add("hidden");
    }
  }

  // Handle logout
  async function handleLogout() {
    if (window.sessionManager) {
      try {
        await window.sessionManager.logout();
        showMessage("âœ… Logged out successfully", "success");
        // Reload or redirect after logout
        setTimeout(() => {
          window.location.href = "/";
        }, 500);
      } catch (error) {
        console.error("Logout error:", error);
        showMessage("âŒ Logout failed: " + error.message, "error");
      }
    }
  }

  // Update UI on page load and auth changes
  if (typeof window !== "undefined") {
    // Initial check
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", updateAuthUI);
    } else {
      updateAuthUI();
    }

    // Listen for auth state changes
    window.addEventListener("auth-changed", updateAuthUI);
  }
</script>
{{end}}

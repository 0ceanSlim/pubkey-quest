{{define "tab-home"}}
<div id="tab-home" class="tab-content">
  <div class="rounded-xl shadow-xl overflow-hidden win95-outset">
    <div class="p-6 md:p-8">
      <!-- Hero Section -->
      <div class="text-center mb-8">
        <h1 class="text-3xl md:text-4xl font-bold mb-3" style="color: var(--color-textHighlighted);">
          Pubkey Quest
        </h1>
        <p class="text-lg md:text-xl mb-4" style="color: var(--color-textSecondary);">
          Your Nostr Identity Becomes a D&D Adventure
        </p>
        <p class="mb-6" style="color: var(--color-textMuted);">
          A web-based RPG that generates your unique character from your Nostr public key.
          Explore a persistent world, battle monsters, cast spells, and become a legend.
        </p>
      </div>

      <!-- CTA Section (Not Logged In) -->
      <!--
        TODO: Future Feature - Character Mining / Vanity Character Generation
        Add a "Mine Character" button here that takes users to /discover page where they can:
        - Generate random Nostr keys and see the character that would be created
        - "Mine" for characters with specific traits (race, class, stats, etc.)

        Mining Architecture:
        1. Browser-based mining (client-side JavaScript)
           - Users can mine directly in their browser
           - No server load, runs entirely on user's device
           - User specifies desired traits and lets it run
           - May have performance limitations depending on browser

        2. Downloadable mining tool (standalone app/CLI)
           - More efficient than browser mining
           - Users can mine characters on their own computer with full control
           - No cost, unlimited attempts, runs locally
           - User specifies desired traits and lets it run
           - Similar to Bitcoin mining - do it yourself for free
           - Can utilize multiple CPU cores for faster mining

        Note: Server-side mining is NOT implemented because it would require handling
        private keys on the server, which is a security risk. All mining must be done
        client-side to maintain Nostr's security model.
      -->
      <div id="home-cta-loggedout" class="text-center mb-8">
        <p class="text-sm mb-4" style="color: var(--color-textMuted);">
          ğŸ” Secure Nostr authentication â€¢ ğŸ² Deterministic character generation â€¢ ğŸ’¾ Save your progress
        </p>
        <a href="/discover" class="action-button-primary pixel-clip px-3 py-2 text-xs sm:px-6 sm:py-3 sm:text-sm inline-block hover:opacity-90 transition">
          ğŸ”® Discover Your Character
        </a>
      </div>

      <!-- Logged In Section -->
      <div id="home-cta-loggedin" class="hidden text-center mb-8 px-2">
        <div class="win95-outset p-4 sm:p-8 rounded-lg inline-block w-full max-w-lg">
          <p class="text-lg sm:text-2xl md:text-3xl font-bold mb-4 sm:mb-6" style="color: var(--color-textHighlighted);">
            Welcome back, <span id="home-username">Hero</span>!
          </p>
          <a href="/saves" class="action-button-primary pixel-clip p-3 sm:p-4 text-sm sm:text-base inline-block hover:opacity-90 transition w-full sm:w-auto">
            Continue Adventure
          </a>
        </div>
      </div>

      <!-- Game Features -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-3 mb-6 max-w-5xl mx-auto">
        <div class="win95-inset p-3 rounded-lg">
          <div class="font-bold mb-1 text-sm" style="color: var(--color-textHighlighted);">ğŸ—ºï¸ Travel & Exploration</div>
          <p class="text-xs" style="color: var(--color-textMuted);">Journey between locations through linked environments. Combat, loot, and random events happen along the way.</p>
        </div>
        <div class="win95-inset p-3 rounded-lg">
          <div class="font-bold mb-1 text-sm" style="color: var(--color-textHighlighted);">ğŸ‘¥ NPCs & Interactions</div>
          <p class="text-xs" style="color: var(--color-textMuted);">Meet characters throughout cities who offer services, tasks, and stories that unlock rewards.</p>
        </div>
        <div class="win95-inset p-3 rounded-lg">
          <div class="font-bold mb-1 text-sm" style="color: var(--color-textHighlighted);">ğŸ– Survival & Resources</div>
          <p class="text-xs" style="color: var(--color-textMuted);">Manage hunger and fatigue. Use items to stay alive and maintain your edge in dangerous situations.</p>
        </div>
        <div class="win95-inset p-3 rounded-lg">
          <div class="font-bold mb-1 text-sm" style="color: var(--color-textHighlighted);">â­ Progression & Growth</div>
          <p class="text-xs" style="color: var(--color-textMuted);">Gain experience, level up, and unlock abilities. Build your reputation as you grow stronger.</p>
        </div>
      </div>

      <!-- Links -->
      <div class="text-center space-y-3">
        <div>
          <a href="https://happytavern.co" target="_blank" class="text-lg hover:opacity-80 transition" style="color: var(--color-textHighlighted);">
            ğŸ» Visit Happy Tavern
          </a>
        </div>
        <div class="flex flex-wrap justify-center gap-4 text-sm">
          <a href="https://github.com/0ceanSlim/pubkey-quest" target="_blank" class="hover:opacity-80" style="color: var(--color-textSecondary);">
            ğŸ’» GitHub
          </a>
          <a href="#about" class="hover:opacity-80" style="color: var(--color-textSecondary);">
            ğŸ“š Learn More
          </a>
          <a href="#contribute" class="hover:opacity-80" style="color: var(--color-textSecondary);">
            ğŸ¤ Contribute
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Update home tab based on auth state
  function updateHomeAuthUI() {
    const loggedOutCTA = document.getElementById('home-cta-loggedout');
    const loggedInCTA = document.getElementById('home-cta-loggedin');
    const username = document.getElementById('home-username');

    if (window.sessionManager && window.sessionManager.isAuthenticated()) {
      // Logged in
      if (loggedOutCTA) loggedOutCTA.classList.add('hidden');
      if (loggedInCTA) loggedInCTA.classList.remove('hidden');

      // Update username
      if (window.profileManager && window.profileManager.getProfile()) {
        const profile = window.profileManager.getProfile();
        const name = profile.display_name || profile.name || profile.npub?.slice(0, 10) + '...';
        if (username) username.textContent = name;
      }
    } else {
      // Not logged in
      if (loggedOutCTA) loggedOutCTA.classList.remove('hidden');
      if (loggedInCTA) loggedInCTA.classList.add('hidden');
    }
  }

  // Listen for auth changes
  window.addEventListener('auth-changed', updateHomeAuthUI);
  window.addEventListener('profile-updated', updateHomeAuthUI);

  // Initial check
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', updateHomeAuthUI);
  } else {
    updateHomeAuthUI();
  }
</script>
{{end}}
